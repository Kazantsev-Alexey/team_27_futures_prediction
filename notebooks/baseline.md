### Третий чекпоинт: Прогнозирование цен на фьючерсы и фонды

Для третьего чекпоинта мы прогнозировали цены на **фьючерсы** (`CL=F`, `BZ=F`) и **фонды** (S&P 500 и NASDAQ-100).  
Мы подошли к этой задаче больше как к **задаче регрессии**, чем к задаче классического анализа временных рядов.  
Основная идея заключалась в том, чтобы использовать **дополнительные данные**, такие как:
- **Статистические признаки** (`MACD`, `DEMA`, `WMA`),
- **Признаки, полученные из новостного сентимента**.

Цель была не просто экстраполировать поведение временного ряда на основе его известных значений, а **предсказывать изменения цен** на основе этих дополнительных данных.

### Почему мы использовали линейные модели?

Мы сфокусировались на моделях регрессии: **линейная регрессия**, **Ridge** и **Lasso**.  
Эти модели хорошо подходили для нашего подхода, потому что:
- Позволяют **напрямую изучить связь между признаками и ценой**.
- Регуляризация в Ridge и Lasso помогает **справляться с переобучением** и выделять наиболее важные признаки.

### Ссылки на обучающие ноутбуки и сохранённые модели

- Анализ обучения моделей, отбор признаков и горизонта прогнозирования описан в ноутбуке:  
  [Linear_models_fit.ipynb](https://github.com/Maksim-de/team_27_futures_prediction/blob/main/notebooks/Linear_models_fit.ipynb)
- Обученные модели, их признаки и скейлеры сохранены в папке:  
  [saved_models](https://github.com/Maksim-de/team_27_futures_prediction/tree/main/saved_models)

---

### Оценка качества моделей: MAPE и MSE

Для оценки качества моделей мы выбрали две метрики:
- **Mean Absolute Percentage Error (MAPE)**
- **Mean Squared Error (MSE)**

Мы выбрали именно эти метрики, так как они логично дополняют наш подход:

1. **MSE**:
   - Линейные модели по своей природе минимизируют MSE, что позволило нам оценить, насколько хорошо модели справляются с основной задачей — минимизацией среднеквадратической ошибки.
   - MSE также чувствительна к большим отклонениям, что особенно важно для прогнозирования цен, где крупные ошибки могут привести к значительным финансовым рискам.

2. **MAPE**:
   - MAPE использовалась для дополнительной интерпретации точности.  
   - В контексте цен активов разница в 2 доллара для актива стоимостью $50 и для актива стоимостью $300 имеет разное значение. MAPE помогает учитывать **масштаб каждого актива** и позволяет сравнивать модели, обученные на разных активах, в одних и тех же терминах.

Таким образом, MSE показывала, как хорошо модели решают основную задачу минимизации ошибок, а MAPE — насколько удобно интерпретировать точность их прогнозов."

**Результаты (дублирует информацию из Readme.md):**
- Для каждого из финансовых тикеров (**CL=F**, **BZ=F**, **SPY**, **QQQ**):
  - модели сначала провалидированы отдельно на тестовых данных;
  - затем обучены на полном объеме данных.
- Во всех случаях итоговой моделью была выбрана **Ridge регрессия**.
- Минимальный горизонт прогнозирования, на котором модель перестаёт предсказывать последние известные значения и адекватно понимает колебания разницы цен, — **20 дней**.
- Для каждой модели отобран набор признаков, исключающих переобучение.
- По метрикам **MAPE** и **MSE** на тестовых данных достигнут удовлетворительный уровень (MAPE на тестовых данных в диапазоне от 0.025 до 0.036)
- Для каждого тикера сохранены:
  - модель;
  - скейлер;
  - списки признаков.

**Текущие проблемы:**
- Недостаточность информации для описания всей дисперсии:
  - серьёзные отклонения на некоторых участках временных рядов;
  - амплитуды колебаний не всегда соответствуют фактическим;
  - иногда отсутствуют значительные сдвиги.
- Возможные решения:
  - добавление признаков о событиях в мире;
  - выделение сущностей из новостных источников, о которых идёт речь.
